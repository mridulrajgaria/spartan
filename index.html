<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpartanPlays Cyber Awareness Quiz</title>
    <link rel="icon" href="BrandLogo-10-05-2021-21-12-30-PM.png" type="image/png">
    <style>
    :root {
      --primary-color: #2e0673;
      --secondary-color: #05b941;
      --button-bg: #ff4400;
      --button-text: #030302;
      --glow-color: #0ff;
    }

    * {
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }

    body {
      background: #060303;
      font-family: 'Poppins', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
    }

    /* Digital Rain Effect */
    .matrix-rain {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .matrix-rain canvas {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    /* Hexagon Grid Background */
    .hex-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        linear-gradient(90deg, transparent 49%, rgba(5, 185, 65, 0.1) 50%, transparent 51%) 0 0 / 50px 50px,
        linear-gradient(transparent 49%, rgba(5, 185, 65, 0.1) 50%, transparent 51%) 0 0 / 50px 50px;
      animation: hexMove 20s linear infinite;
      opacity: 0.5;
    }

    @keyframes hexMove {
      0% { background-position: 0 0; }
      100% { background-position: 50px 50px; }
    }

    /* Cybersecurity Icons Animation */
    .cyber-icons {
      position: fixed;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .cyber-icon {
      position: absolute;
      width: 30px;
      height: 30px;
      background: rgba(5, 185, 65, 0.2);
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      animation: iconFloat 10s linear infinite;
    }

    @keyframes iconFloat {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      50% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) rotate(360deg);
        opacity: 0;
      }
    }

    .quiz-container {
      position: relative;
      z-index: 1;
      background: rgba(0, 0, 0, 0.85);
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(5, 185, 65, 0.5);
      max-width: 600px;
      width: 100%;
      overflow: hidden;
      border: 1px solid rgba(5, 185, 65, 0.3);
      animation: borderGlow 2s ease-in-out infinite;
      backdrop-filter: blur(10px);
    }

    @keyframes borderGlow {
      0% {
        box-shadow: 0 0 20px rgba(5, 185, 65, 0.5);
        border-color: rgba(5, 185, 65, 0.3);
      }
      50% {
        box-shadow: 0 0 30px rgba(5, 185, 65, 0.8);
        border-color: rgba(5, 185, 65, 0.6);
      }
      100% {
        box-shadow: 0 0 20px rgba(5, 185, 65, 0.5);
        border-color: rgba(5, 185, 65, 0.3);
      }
    }

    .quiz-header {
      background: rgba(5, 185, 65, 0.1);
      color: #fff;
      text-shadow: 0 0 10px rgba(5, 185, 65, 0.5);
    }

    .quiz-body {
      color: #fff;
    }

    .quiz-body ul li {
      background: rgba(5, 185, 65, 0.1);
      border: 1px solid rgba(5, 185, 65, 0.3);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .quiz-body ul li:hover {
      transform: translateX(10px);
      background: rgba(5, 185, 65, 0.2);
    }

    .quiz-body ul li::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(5, 185, 65, 0.8));
      animation: scanLine 2s linear infinite;
    }

    @keyframes scanLine {
      0% { left: -100%; }
      50% { left: 100%; }
      100% { left: 100%; }
    }

    button {
      background: rgba(5, 185, 65, 0.3);
      border: 1px solid rgba(5, 185, 65, 0.5);
      color: #fff;
      text-shadow: 0 0 5px rgba(225, 231, 227, 0.5);
      transition: all 0.3s ease;
    }

    button:hover {
      background: rgba(5, 185, 65, 0.5);
      box-shadow: 0 0 15px rgba(129, 189, 149, 0.5);
    }

    #timer {
      color: rgba(5, 185, 65, 1);
      text-shadow: 0 0 10px rgba(78, 190, 115, 0.5);
    }

    /* Rest of your existing styles with updated colors */
    </style>
</head>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Front Page</title>
  <style>
      body {
          margin: 0;
          padding: 0;
          background-color: #f4f4f4;
          position: relative;
      }

      .logo-left,
      .logo-right {
          position: absolute;
          top: 20px;
          width: 120px;
          z-index: 10; /* Ensures logos appear on top */
      }

      .logo-left {
          left: 20px;
      }

      .logo-right {
          right: 20px;
      }
  </style>
</head>
<body>
  <img src="channels4_profile.jpg" alt="MP Police Logo" class="logo-right">
  <img src="Screenshot%202025-02-08%20012202.png" alt="VIT Bhopal Logo" class="logo-left">
</body>
<body>
    <div class="matrix-rain"></div>
    <div class="hex-background"></div>
    <div class="cyber-icons"></div>

    <!-- Rest of your existing HTML... -->

    <script>
    // Matrix Rain Effect
    function setupMatrixRain() {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      document.querySelector('.matrix-rain').appendChild(canvas);

      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const chars = '01';
      const fontSize = 14;
      const columns = canvas.width / fontSize;
      const drops = [];

      for (let i = 0; i < columns; i++) {
        drops[i] = 1;
      }

      function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = '#0f0';
        ctx.font = fontSize + 'px monospace';

        for (let i = 0; i < drops.length; i++) {
          const text = chars.charAt(Math.floor(Math.random() * chars.length));
          ctx.fillText(text, i * fontSize, drops[i] * fontSize);

          if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
            drops[i] = 0;
          }
          drops[i]++;
        }
      }

      setInterval(draw, 33);
    }

    // Cyber Icons Animation
    function createCyberIcons() {
      const container = document.querySelector('.cyber-icons');
      const iconCount = 30;

      for (let i = 0; i < iconCount; i++) {
        const icon = document.createElement('div');
        icon.className = 'cyber-icon';
        
        icon.style.left = Math.random() * 100 + 'vw';
        icon.style.animationDelay = (Math.random() * 5) + 's';
        icon.style.animationDuration = (Math.random() * 5 + 5) + 's';
        
        container.appendChild(icon);
      }
    }

    // Initialize animations
    document.addEventListener('DOMContentLoaded', () => {
      setupMatrixRain();
      createCyberIcons();
    });

    // Scanning effect for answer options
    function addScanningEffect() {
      const options = document.querySelectorAll('.quiz-body ul li');
      options.forEach(option => {
        option.addEventListener('mouseover', () => {
          option.style.transform = 'translateX(10px)';
          option.style.boxShadow = '0 0 15px rgba(5, 185, 65, 0.5)';
        });
        
        option.addEventListener('mouseout', () => {
          option.style.transform = 'translateX(0)';
          option.style.boxShadow = 'none';
        });
      });
    }

    // Rest of your existing JavaScript...
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpartanPlays Cyber Awareness Quiz</title>
    <link rel="icon" href="BrandLogo-10-05-2021-21-12-30-PM.png" type="image/png">
  <style>
    :root {
  --primary-color: #060507;
  --secondary-color: #05b941;
  --button-bg: #00ff33;
  --button-text: #030302;
}

* {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}

body {
  background: radial-gradient(circle, var(--primary-color) 0%, rgba(255, 255, 255, 1) 100%);
  font-family: 'Poppins', sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
}

.quiz-container {
  position: relative; 
  z-index: 1; 
  background: #0c0d04;
  border-radius: 10px;
  box-shadow: 0 0 10px 2px rgba(100, 100, 100, 0.1);
  max-width: 600px;
  width: 100%;
  overflow: hidden;
}
.quiz-header,
.quiz-footer {
  padding: 1rem 2rem;
}

.quiz-footer {
  position: relative; 
  z-index: 2; 
  padding: 1rem 2rem;
}

.quiz-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: #201e46;
  
  box-shadow: 0px 0px 5px rgba(155, 24, 24, 0.5);
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
}

.quiz-header h2 {
  font-size: 1.5rem;
}

.quiz-header p {
  background: var(--secondary-color);
  padding: 0.4rem 1rem;
  color: #bfe860;
  border-radius: 5px;
}

.quiz-body {
  padding: 1.5rem 2rem;
}

.quiz-body h2 {
  padding: 0rem 0;
  font-size: 1.36rem;
  font-weight: 790;
  text-align: justify;
  margin: 0;
}

.quiz-body h1 {
  text-align: center;
  padding-bottom: 20px;
}

.quiz-body ul {
  list-style: none;
  padding: 0;
}

.quiz-body ul li {
  margin: 1rem 0;
  font-size: 1rem;
  border: 1px solid #7a999b;
  padding: 0.7rem;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.quiz-body ul li label {
  cursor: pointer;
  padding: 0 0.4rem;
}

.quiz-body ul li:hover {
  background-color: rgb(187, 178, 164)
}

.quiz-footer button,
.btn {
  position: relative; 
  z-index: 3; 
  margin-bottom: 28px;
  margin-top: 12px;
  padding: 0.6rem 1.5rem;
  outline: none;
  background: var(--button-bg);
  border: 0;
  cursor: pointer;
  font-family: inherit;
  border-radius: 5px;
  color: var(--button-text);
  opacity: 0.9;
  transition: opacity 0.3s ease, background-color 0.3s ease;
}

.quiz-body button {
  display: block;
  margin: 0 auto;
}

.quiz-footer button:hover,
.btn:hover {
  opacity: 1;
  background-color: var(--button-bg);
}
.quiz-details {
    color: #a9eb04;  /* Neon green color - same as your timer */
    font-size: 17px;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(191, 222, 16, 0.3);
    margin-top: 4px;
}
.popup-container {
  position: fixed; 
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 4; 
}

.popup {
  background-color: #ca1ec7;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  z-index: 5; 
}

button {
  background-color: #2514a9;
  padding: 12px 24px;
  color: #f0e006;
  cursor: pointer;
  border-radius: 5px;
  font-size: 16px;
  border: none;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #1a1c20;
}

.correct {
  background-color: rgb(207, 231, 21);
}

.wrong {
  background-color: #e6570a;
}

#timer {
  font-size: 17px;
  font-weight: bold;
  margin-left: 6px;
  color: #a9eb04;
  margin-top: 4px;
  text-align: center;
  text-shadow: 1px 1px 2px rgba(191, 222, 16, 0.3);
}

/* Responsive Styles */
@media screen and (max-width: 768px) {
  .quiz-container {
    max-width: 90%;
  }
  .popup {
    background-color: #a465b4; 
  }
}

  </style>
    
</head>
<body>
    <div class="quiz-container" id="quiz">
        <div class="quiz-header">
          <h2 class="header-txt">SpartanPlays Cyber Awareness Quiz</h2>
          <div id="timer"></div>
        </div>
        <div class="quiz-body">
          
          <h2 id="question">Question Text</h2>
          <ul>
            <li>
              <input type="radio" name="answer" id="a" class="answer" />
              <label for="a" id="a_text">Questions</label>
            </li>
            <div class="popup-container" id="popupContainer">
              <div class="popup">
                <h2 style="text-align: center;">Welcome to SpartanPlays Cyber Awareness Quiz ! </h2>
                <br>  
                <h3>Please review the Terms and Conditions before beginning the assessment: </h3><br>
                <p>1.The assessment consists of 20 scenario-based cyber security questions, each worth 1 mark, with a time limit of 20 minutes.</p>
                <br><p>2.Before proceeding to the next question, ensure that you have saved the current option for evaluation.</p>
                <br><p>3.Once you click the "Save" button, you cannot change the option.</p>
                <br><p>4.There is only one correct answer for each question.</p>
                
                <br>
                <form id="scoreForm">
                  <div style="display: flex; justify-content: center; align-items: center;">
                  <input type="text" id="employeeID" placeholder="Enter Employee ID" style="height: 30px;" required>
                  
                  </div>
                  <br>
                  <button type="button" id="startAssessmentBtn">Start Assessment</button>
              </form>
              </div>
            </div>
            <li>
              <input type="radio" name="answer" id="b" class="answer" />
              <label for="b" id="b_text">Questions</label>
            </li>
            <li>
              <input type="radio" name="answer" id="c" class="answer" />
              <label for="c" id="c_text">Questions</label>
            </li>
            <li>
              <input type="radio" name="answer" id="d" class="answer" />
              <label for="d" id="d_text">Questions</label>
            </li>
          </ul>
        </div>
        <div class="quiz-footer">
          <div class="quiz-details"></div>
          <button id="backBtn" style="margin-right: 14px;" >Back</button>
          <button id="saveBtn">Save</button>
          <button id="nextBtn" style="margin-left: 15px">Next</button>
        </div>
      </div>
      <!-- <script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-firestore.js"></script> -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
      <script> 
      "use strict";
document.addEventListener("contextmenu", (e) => e.preventDefault());
document.addEventListener("copy", (e) => e.preventDefault());
document.addEventListener("paste", (e) => e.preventDefault());

window.addEventListener("beforeunload", function (e) {
  e.returnValue = '';  
});

let quizstarted = false;
let tabSwitchCount = 0;

document.addEventListener("visibilitychange", () => {
  if (!quizstarted) return; // Check if the quiz has started
  
  if (document.visibilityState === "hidden") {
    tabSwitchCount++;

    if (tabSwitchCount <= 2) {
      alert("Do not switch tabs as it will lead to the quiz being submitted!");
    }

    if (tabSwitchCount > 2) {
      endQuizDueToTabSwitch();
    }
  }
});

function endQuizDueToTabSwitch() {
  quizstarted = false; // Stop the quiz
  alert("You have switched tabs more than twice. The quiz has ended.");
  if (typeof displayResults === "function") {
    displayResults();
  } else {
    console.error("displayResults function is not defined.");
  }
}


const quizData = [
  {
    question: "फ़िशिंग अटैक का पता लगाओ! तुम्हें एक ईमेल आता है जो 'बैंक' का लगता है, और वो कह रहा है कि तुरंत अकाउंट वेरीफाई करो। क्या करोगे?",
    a: "लिंक पर क्लिक करके जल्दी से डिटेल्स डाल दोगे।",
    b: "इग्नोर कर दोगे, बैंक कभी ऐसे ईमेल नहीं भेजते।",
    c: "सेंडर का ईमेल चेक करोगे, लिंक पर होवर करोगे, और बैंक से डायरेक्ट कॉन्टैक्ट करोगे।",
    d: "सब दोस्तों को फॉरवर्ड कर दोगे ताकि सबको पता चले।",
    correct: "c"
  },
  {
    question: "कौन सा पासवर्ड सबसे स्ट्रॉन्ग है?",
    a: "Password123",
    b: "P@$$w0rd!",
    c: "F#z8Yp$k@h1L9X",
    d: "MyName2023",
    correct: "c"
  },
  {
    "question": "फिशिंग हमले में मुख्य रूप से किसका उपयोग किया जाता है?",
    "a": "मालवेयर (Malware)",
    "b": "धोखाधड़ी वाले ईमेल और वेबसाइट",
    "c": "फायरवॉल सुरक्षा",
    "d": "एंटीवायरस सॉफ़्टवेयर",
    "correct": "b"
  },
  {
    question: "टू-फैक्टर ऑथेंटिकेशन (2FA) का मतलब क्या है?",
    a: "बस पासवर्ड डालना काफी है।",
    b: "पासवर्ड के बाद एक OTP या ऑथेंटिकेशन ऐप का कोड डालना।",
    c: "नए डिवाइस से बिना किसी एक्स्ट्रा चेक के लॉगिन करना।",
    d: "सब अकाउंट्स के लिए एक ही पासवर्ड इस्तेमाल करना।",
    correct: "b"
  },
  {
    question: "फेक वेबसाइट को कैसे पकड़ेंगे?",
    a: "बस वेबसाइट का डिज़ाइन देखकर ट्रस्ट कर लेंगे।",
    b: "'http' और 'https' चेक करेंगे, https सिक्योर होता है।",
    c: "अगर साइट लोड होने में टाइम ले रही है तो फेक है।",
    d: "अगर डिस्काउंट ज्यादा मिल रहा है तो ओरिजिनल है।",
    correct: "b"
  },
  {
    question: "रैंसमवेयर अटैक हो गया! क्या नहीं करना चाहिए?",
    a: "पैसे देकर फाइल्स वापस लेने की कोशिश।",
    b: "इंटरनेट डिस्कनेक्ट करके रिपोर्ट करना।",
    c: "बैकअप से फाइल्स रिस्टोर करना।",
    d: "आईटी एक्सपर्ट से मदद लेना।",
    correct: "a"
  },
  {
    question: "सोशल इंजीनियरिंग अटैक का उदाहरण क्या है?",
    a: "किसी ने तुम्हारे सिस्टम में वायरस डाल दिया।",
    b: "एक फेक कॉल आई जो तुमसे पासवर्ड मांग रही थी।",
    c: "तुम्हारे फोन का डेटा हैक हो गया।",
    d: "तुमने एक ईमेल ओपन की और सिस्टम स्लो हो गया।",
    correct: "b"
  },
  {
    question: "फ्रेंड के अकाउंट से आया सस्पिशस लिंक! क्या करोगे?",
    a: "क्लिक करके चेक करोगे।",
    b: "फ्रेंड से पूछोगे कि उसने भेजा है या नहीं।",
    c: "प्लेटफॉर्म पर रिपोर्ट करोगे और फ्रेंड को बताओगे।",
    d: "दोस्तों के बीच शेयर कर दोगे।",
    correct: "c"
  },
  {
    question: "स्मार्टफोन सिक्योर कैसे रखें?",
    a: "सिर्फ 4-डिजिट PIN यूज़ करें।",
    b: "फिंगरप्रिंट या फेस आईडी के साथ स्ट्रॉन्ग पासकोड लगाएं।",
    c: "फोन लॉक मत करें ताकि जल्दी एक्सेस मिले।",
    d: "'1234' या 'password' जैसा सिंपल पासवर्ड रखें।",
    correct: "b"
  },
  {
    question: "पासवर्ड्स स्टोर करने का सबसे सेफ तरीका क्या है?",
    a: "नोटबुक में लिख लो।",
    b: "एक पासवर्ड हर जगह इस्तेमाल करो।",
    c: "ट्रस्टेड पासवर्ड मैनेजर में सेव करो।",
    d: "टेक्स्ट फाइल में लिख लो।",
    correct: "c"
  },
  {
    question: "पब्लिक Wi-Fi इस्तेमाल करना है, क्या सबसे सेफ है?",
    a: "बस कनेक्ट कर लो, फ्री है!",
    b: "VPN इस्तेमाल करो जब भी सेंसिटिव इनफॉर्मेशन एक्सेस कर रहे हो।",
    c: "होटल या कॉफी शॉप का Wi-Fi इस्तेमाल करना सेफ होता है।",
    d: "जो भी Wi-Fi नाम ऑफिशियल लगे, उस पर ट्रस्ट कर लो।",
    correct: "b"
  },
  {
    question: "ऑनलाइन क्विज में तुमसे पहले पेट का नाम पूछा जाए तो?",
    a: "मज़ा आएगा, तुरंत आंसर करेंगे!",
    b: "अवॉइड करेंगे, हैकर्स सिक्योरिटी क्वेश्चंस का आंसर कलेक्ट करते हैं।",
    c: "फ्रेंड्स के साथ शेयर करेंगे।",
    d: "फेक आंसर लिख देंगे।",
    correct: "b"
  },
  {
    question: "कौन सा मैलवेयर तुम्हारे कीस्ट्रोक्स रिकॉर्ड करता है?",
    a: "रैंसमवेयर",
    b: "ट्रोजन",
    c: "कीलॉगर",
    d: "वॉर्म",
    correct: "c"
  },
  {
    question: "सिक्योर वेबसाइट को कैसे पहचानेंगे?",
    a: "ग्रीन बैकग्राउंड है तो सेफ है।",
    b: "'https://' और पैडलॉक आइकन होना चाहिए।",
    c: "साइट फास्ट लोड हो रही है।",
    d: "नाम में 'secure' लिखा है।",
    correct: "b"
  },
  {
    question: "स्कैम कॉल की पहचान कैसे करें?",
    a: "कॉलर बोल रहा है कि जल्दी डिसीजन लो।",
    b: "पर्सनल इनफॉर्मेशन मांग रहा है।",
    c: "धमकी दे रहा है कि नहीं किया तो नुकसान होगा।",
    d: "सभी ऑप्शंस सही हैं।",
    correct: "d"
  },
  {
    question: "अगर अकाउंट हैक हो जाए तो क्या करना चाहिए?",
    a: "तुरंत पासवर्ड चेंज करो।",
    b: "एक्टिविटी चेक करो और 2FA इनेबल करो।",
    c: "प्लेटफॉर्म को रिपोर्ट करो।",
    d: "सब कुछ करो!",
    correct: "d"
  },
  {
    question: "सेफ ईमेल प्रैक्टिस क्या हैं?",
    a: "अननोन सेंडर्स के अटैचमेंट्स ओपन करना।",
    b: "एक ही पासवर्ड सभी अकाउंट्स के लिए यूज़ करना।",
    c: "रेगुलर पासवर्ड अपडेट और 2FA इनेबल करना।",
    d: "हर ईमेल लिंक पर बिना चेक किए क्लिक करना।",
    correct: "c"
  },
  {
    question: "अगर तुम्हें कोई USB ड्राइव मिलती है तो क्या करोगे?",
    a: "प्लग करके चेक करेंगे कि अंदर क्या है।",
    b: "आईटी या सिक्योरिटी टीम को दे देंगे।",
    c: "खुद यूज़ करेंगे।",
    d: "दोस्तों के बीच शेयर कर देंगे।",
    correct: "b"
  },
  {
    question: "फेक ऐप को कैसे पकड़ेंगे?",
    a: "पुअर रिव्यूज और ज्यादा परमिशन्स मांग रहा हो।",
    b: "फ्री है।",
    c: "लोगो अच्छा लग रहा है।",
    d: "फ्रेंड ने रिकमेंड किया है।",
    correct: "a"
  },
  {
    question: "शेयर्ड डिवाइस पर लॉग आउट क्यों करना चाहिए?",
    a: "किसी और को एक्सेस ना मिले।",
    b: "नया लॉगिन स्पेस बनाने के लिए।",
    c: "बैटरी बचाने के लिए।",
    d: "पेज रिफ्रेश करने के लिए।",
    correct: "a"
  }
];

const backBtn = document.getElementById("backBtn");
const nextBtn = document.getElementById("nextBtn");
nextBtn.disabled = true;
backBtn.addEventListener("click", previousQuestion);

function startQuiz() {
  quizstarted=true;
  console.log('Quiz started');
  const employeeID = employeeIDInput.value.trim();
  console.log('Employee ID:', employeeID);
  nextBtn.disabled = false;
  // backBtn.disabled = false;

  startTimer(20 * 60);
  document.getElementById('popupContainer').style.display = 'none';
  document.getElementById('quiz-container').style.display = 'block';
}

const saveBtn = document.getElementById("saveBtn");
saveBtn.addEventListener("click", saveAnswer);
nextBtn.addEventListener("click", nextQuestion);

let userAnswers = [];
let scoredQuestions = []; // New array to track scored questions

const quiz = document.querySelector(".quiz-body");
const answerEl = document.querySelectorAll(".answer");
const questionEl = document.getElementById("question");
const footerEl = document.querySelector(".quiz-footer");
const quizDetailEl = document.querySelector(".quiz-details");
const liEl = document.querySelector("ul li");

const a_txt = document.getElementById("a_text");
const b_txt = document.getElementById("b_text");
const c_txt = document.getElementById("c_text");
const d_txt = document.getElementById("d_text");
const btnSubmit = document.getElementById("btn");

let currentQuiz = 0;
let score = 0;

loadQuiz();

function loadQuiz() {
  deselectAnswers();
  markSavedAnswer();
  const currentQuizData = quizData[currentQuiz];
  questionEl.innerText = currentQuizData.question;
  a_txt.innerText = currentQuizData.a;
  b_txt.innerText = currentQuizData.b;
  c_txt.innerText = currentQuizData.c;
  d_txt.innerText = currentQuizData.d;
  quizDetailEl.innerHTML = `<p>${currentQuiz + 1} of ${quizData.length}</p>`;
  answerEl.forEach((answerEl) => {
    answerEl.disabled = false;
  });
  if (currentQuiz === quizData.length - 1) {
    nextBtn.innerText = "View Results";
    nextBtn.removeEventListener("click", nextQuestion);
    nextBtn.addEventListener("click", displayResults);
  } else {
    nextBtn.innerText = "Next";
    nextBtn.removeEventListener("click", displayResults);
    nextBtn.addEventListener("click", nextQuestion);
  }
}

function deselectAnswers() {
  answerEl.forEach((answerEl) => {
    answerEl.checked = false;
    answerEl.parentElement.classList.remove("correct", "wrong");
  });

  const feedbackElements = footerEl.querySelectorAll(".correct-feedback, .incorrect-feedback");
  feedbackElements.forEach((element) => {
    element.remove();
  });
}

function getSelected() {
  let answer;
  answerEl.forEach((answerEls) => {
    if (answerEls.checked) {
      answer = answerEls.id;
    }
  });
  return answer;
}

function nextQuestion() {
  saveBtn.disabled = false;

  currentQuiz++;

  if (currentQuiz < quizData.length) {
    loadQuiz();
  }

  if (currentQuiz === quizData.length - 1) {
    nextBtn.innerText = "View Results";
    nextBtn.removeEventListener("click", nextQuestion);
    nextBtn.addEventListener("click", displayResults);
  } else {
    nextBtn.innerText = "Next";
    nextBtn.removeEventListener("click", displayResults);
    nextBtn.addEventListener("click", nextQuestion);
  }

  backBtn.disabled = false;
}
function saveAnswer() {
  const answer = getSelected();
  const correctAnswer = quizData[currentQuiz].correct;
  if (!answer) {
    return;
  }
  if (userAnswers[currentQuiz] !== undefined) {
    return;
  }
  answerEl.forEach((answerEl) => {
    const id = answerEl.id;
    if (id === correctAnswer) {
      answerEl.parentElement.classList.add("correct");
    } else {
      if (id === answer) {
        answerEl.parentElement.classList.add("wrong");
      }
    }
  });

  const isCorrect = answer === correctAnswer;
  const feedback = document.createElement("p");
  feedback.classList.add(isCorrect ? "correct-feedback" : "incorrect-feedback");
  footerEl.appendChild(feedback);

  nextBtn.disabled = false;
  if (userAnswers[currentQuiz] === undefined) {
    userAnswers[currentQuiz] = answer;
  }

  console.log("User Answer:", answer);
  console.log("Correct Answer:", correctAnswer);
  console.log("Is Correct?", isCorrect);

  if (isCorrect && !scoredQuestions.includes(currentQuiz)) {
    score++;
    scoredQuestions.push(currentQuiz); // Mark the question as scored
    console.log("Score:", score);
  }
}


let timerRunning = true;
let remainingTimeInSeconds = 20 * 60;

function startTimer(duration) {
  let timer = duration, minutes, seconds;
  const timerDisplay = document.getElementById('timer');

  const intervalID = setInterval(function () {
    console.log("Interval Running...");
    if (!timerRunning) {
      clearInterval(intervalID);
      console.log("Timer Stopped");
      return;
    }
    console.log("Timer Running...");
    minutes = parseInt(timer / 60, 10);
    seconds = parseInt(timer % 60, 10);

    minutes = minutes < 10 ? '0' + minutes : minutes;
    seconds = seconds < 10 ? '0' + seconds : seconds;

    if (timer < 300) {
      timerDisplay.style.color = 'red';
    }

    timerDisplay.textContent = minutes + ':' + seconds;

    if (--timer < 0) {
      timerDisplay.textContent = 'Time\'s up!';
      timerDisplay.style.fontSize = '28px';
      timerDisplay.style.fontWeight = "bold";
      timerDisplay.style.color = "black";
      timerDisplay.style.PaddingBottom = "11px";
      displayResults();
      clearInterval(intervalID);
    }
  }, 1000);
}

function stopTimer() {
  console.log("Stopping Timer...");
  timerRunning = false;
}

function resumeTimer() {
  startTimer(remainingTimeInSeconds);
}

function displayResults() {
  const headerTxt = document.querySelector(".header-txt");
  headerTxt.textContent = "Results";
  headerTxt.style.fontSize = "30px";
  const scorePercentage = Math.round((score / quizData.length) * 100);
  let remark = "";
  if (scorePercentage >= 90) {
    remark = "Excellent!";
  } else if (scorePercentage >= 75) {
    remark = "Good";
  } else if (scorePercentage >= 50) {
    remark = "Above Average";
  } else if (scorePercentage > 35) {
    remark = "Below Average";
  } else {
    remark = "Retake the quiz";
  }
  quiz.innerHTML = `
    <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%;">
      <h1 style="font-size: 24px; margin-bottom: 10px;">You answered ${score}/${quizData.length} questions correctly</h1>
      <div style="text-align: center; padding-bottom: 20px;">
        <h1 style="font-size: 24px; margin-bottom: 5px;">Your Score Percentage is ${scorePercentage}%</h1>
        <h2 style="font-size: 24px; margin-bottom: 15px; text-align: center;">Remark: ${remark}</h2>
      </div>
      <button type="button" onclick="location.reload()" style="padding: 10px 20px; font-size: 18px; background-color: #007bff; color: white; border: none; cursor: pointer;">Retake</button>
    </div>
  `;
  footerEl.style.display = "none";
  stopTimer();
  document.getElementById('timer').style.display = 'none';
  const quizLength = quizData.length;
  handleQuizCompletion(employeeIDInput.value.trim(), score, quizLength,scorePercentage,remark);
}

function markSavedAnswer() {
  const savedAnswer = userAnswers[currentQuiz];

  if (!savedAnswer) {
    return;
  }

  answerEl.forEach((answerEl) => {
    if (answerEl.id === savedAnswer) {
      answerEl.checked = true;
      answerEl.disabled = true;
      const correctAnswer = quizData[currentQuiz].correct;
      if (savedAnswer === correctAnswer) {
        answerEl.parentElement.classList.add("correct");
      } else {
        answerEl.parentElement.classList.add("wrong");
      }
    }
  });
}

function previousQuestion() {
  console.log("Navigating to previous question...");
  currentQuiz--;

  if (currentQuiz >= 0) {
    loadQuiz();
    markSavedAnswer();

    answerEl.forEach((answerEl) => {
      answerEl.disabled = false;
    });

    if (currentQuiz === quizData.length - 2) {
      const btnSubmit = document.getElementById("nextBtn");
      btnSubmit.innerText = "Next";
    }

    nextBtn.disabled = false;
  } else {
    currentQuiz = 0;
    backBtn.disabled = true;
  }
}


const firebaseConfig = {
  apiKey: "AIzaSyAyh0KTPXxQRQHroqUaG_zQB4PJKMsB_qQ",
  authDomain: "quiz-94195.firebaseapp.com",
  databaseURL: "https://quiz-94195-default-rtdb.firebaseio.com",
  projectId: "quiz-94195",
  storageBucket: "quiz-94195.appspot.com",
  messagingSenderId: "838358419225",
  appId: "1:838358419225:web:cedfd35163dbe209822788"
};



firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();



const scoreForm = document.getElementById('scoreForm');
const employeeIDInput = document.getElementById('employeeID');
const startAssessmentBtn = document.getElementById('startAssessmentBtn');

//const backBtn = document.getElementById('backBtn');
const employeeIDDisplay = document.getElementById('employeeIDDisplay');




startAssessmentBtn.addEventListener('click', function() {
    const employeeID = employeeIDInput.value.trim();

   
    if (employeeID === '') {
        alert('Please enter Employee ID.');
        return;
    }


    startQuiz();
    // startTimer();
});


function saveQuizResults(employeeID, score, percentage, remark) {
  console.log("Saving quiz results:", employeeID, score, percentage, remark);

  // Save to Firestore
  db.collection("quizResults").add({
      employeeID: employeeID,
      score: score,
      percentage: percentage,
      remark: remark,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
  })
  .then(function(docRef) {
      console.log("Quiz results saved successfully with ID: ", docRef.id);
      
      // Save to Excel file
      saveToExcel(employeeID, score, percentage, remark);
  })
  .catch(function(error) {
      console.error("Error adding quiz results: ", error);
  });
}

// Function to save data to Excel
async function saveToExcel(employeeID, score, percentage, remark) {
  let fileName = "quiz_results.xlsx";
  let existingData = [];

  // Try to read the existing file if present
  try {
      const response = await fetch(fileName); // Fetch the existing file (if available)
      if (response.ok) {
          const arrayBuffer = await response.arrayBuffer();
          const workbook = XLSX.read(arrayBuffer, { type: "array" });
          const sheetName = workbook.SheetNames[0];
          existingData = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);
      }
  } catch (error) {
      console.log("No existing file found. Creating a new one...");
  }

  // Append new data
  existingData.push({
      EmployeeID: employeeID,
      Score: score,
      Percentage: percentage,
      Remark: remark,
      Timestamp: new Date().toLocaleString()
  });

  // Convert JSON to worksheet
  let ws = XLSX.utils.json_to_sheet(existingData);

  // Create a new workbook and append the worksheet
  let wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Quiz Results");

  // Save the updated file
  XLSX.writeFile(wb, fileName);

  console.log("Quiz results appended to Excel successfully!");
}





function handleQuizCompletion(employeeID, score, quizLength, scorePercentage, remark) {
  console.log("Handling quiz completion...");
  // const percentage = Math.round((score / quizLength) * 100);

  
  saveQuizResults(employeeID, score, scorePercentage, remark);
}


function quizCompleted() {
  const employeeID = employeeIDInput.value.trim(); 
  const quizLength = quizData.length; 
  
}



      </script>
</body>
</html>
